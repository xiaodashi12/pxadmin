{"remainingRequest":"/Users/cjg/Vue/pxadmin/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!/Users/cjg/Vue/pxadmin/src/utils/fetch.js","dependencies":[{"path":"/Users/cjg/Vue/pxadmin/src/utils/fetch.js","mtime":1622368043543},{"path":"/Users/cjg/Vue/pxadmin/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cjg/Vue/pxadmin/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":["import axios from 'axios';\nimport { Message } from 'element-ui';\nimport { getToken, getLocalStorage, setLocalStorage } from '@/utils/auth';\nimport store from '@/store/store.js';\nimport * as dlgUtils from \"../utils/dialogUtils\";\nimport Vue from 'vue';\nimport ElementUI from 'element-ui';\nvar SUCCESS_CODE = 200;\nimport wsConsts from '@/utils/wsConsts'; // 创建axios实例\n\nvar service = axios.create({\n  baseURL: \"/\",\n  // api的base_url\n  dataType: \"json\",\n  headers: {\n    \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryn8D9asOnAnEU4Js0\"\n  },\n  timeout: 5000 // 请求超时时间\n\n}); // request拦截器\n\nservice.interceptors.request.use(function (config) {\n  // console.log(store.getters)\n  // if (store.getters.token) {\n  //     config.headers.token = getToken();\n  // }\n  // if (config.method.toLowerCase() !== 'get' && Object.keys(config.data).length > 0) {\n  //     let body = {};\n  //     let data = {};\n  //     for (let key in config.data) {\n  //         if (key != 'method') {\n  //             body[key] = config.data[key];\n  //         }\n  //     }\n  //     data = body\n  //     // if (getToken()) {\n  //     //     data.ticket = getToken() || '';\n  //     // }\n  //     config.data = JSON.stringify(data)\n  // }\n  return config;\n}, function (error) {\n  console.log(error); // for debug\n\n  Promise.reject(error);\n});\nVue.prototype.$http = service;\n\nVue.prototype.$post = function (url, data) {\n  return new Promise(function (resolve, reject) {\n    service.post(url, data).then(function (res) {\n      if (res.code == 10001) {\n        resolve(res);\n      } else {\n        ElementUI.Message.error(res.data);\n      }\n    }).catch(function (err) {\n      // ElementUI.Message.error('网络错误，请重试！')\n      console.log(err);\n      reject(err);\n    });\n  });\n};\n\nVue.prototype.$get = function (url) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return new Promise(function (resolve, reject) {\n    service.get(url, {\n      params: params\n    }).then(function (res) {\n      if (res.code == 10001) {\n        resolve(res);\n      } else {\n        ElementUI.Message.error(res.data);\n      }\n    }).catch(function (err) {\n      // ElementUI.Message.error('网络错误，请重试！')\n      console.log(err);\n      reject(err);\n    });\n  });\n}; // respone拦截器\n\n\nservice.interceptors.response.use(function (response) {\n  if (!response.data) {\n    return Promise.reject({\n      code: \"\",\n      message: '网络异常'\n    });\n  }\n\n  var res = response.data;\n  console.log(res);\n\n  if (!res.hasOwnProperty('code')) {\n    return res;\n  }\n\n  var expireTime = getLocalStorage('expireTime');\n\n  if (res.code == 503) {\n    console.log(res);\n    dlgUtils.loginTimeout();\n    return Promise.reject({\n      code: res.code,\n      message: res.data\n    });\n  } else {\n    setLocalStorage('expireTime', new Date().getTime() + 1000 * 60 * 60 * 24 * 7);\n    return res;\n  }\n\n  return Promise.reject({\n    code: res.code,\n    message: res.msg\n  });\n}, function (error) {\n  return Promise.reject({\n    code: error.code,\n    message: error.msg\n  });\n});\nexport default service;",{"version":3,"sources":["/Users/cjg/Vue/pxadmin/src/utils/fetch.js"],"names":["axios","Message","getToken","getLocalStorage","setLocalStorage","store","dlgUtils","Vue","ElementUI","SUCCESS_CODE","wsConsts","service","create","baseURL","dataType","headers","timeout","interceptors","request","use","config","error","console","log","Promise","reject","prototype","$http","$post","url","data","resolve","post","then","res","code","catch","err","$get","params","get","response","message","hasOwnProperty","expireTime","loginTimeout","Date","getTime","msg"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport {Message} from 'element-ui'\nimport {getToken, getLocalStorage, setLocalStorage} from '@/utils/auth'\nimport store from '@/store/store.js'\nimport * as dlgUtils from '../utils/dialogUtils'\nimport Vue from 'vue'\nimport ElementUI from 'element-ui'\nconst SUCCESS_CODE = 200;\nimport wsConsts from '@/utils/wsConsts'\n\n// 创建axios实例\nconst service = axios.create({\n    baseURL: \"/\", // api的base_url\n    dataType:\"json\",\n    headers: {\"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryn8D9asOnAnEU4Js0\" },\n    timeout: 5000 // 请求超时时间\n})\n\n\n// request拦截器\nservice.interceptors.request.use(config => {\n    // console.log(store.getters)\n    // if (store.getters.token) {\n    //     config.headers.token = getToken();\n    // }\n\n\n    // if (config.method.toLowerCase() !== 'get' && Object.keys(config.data).length > 0) {\n    //     let body = {};\n    //     let data = {};\n\n    //     for (let key in config.data) {\n    //         if (key != 'method') {\n    //             body[key] = config.data[key];\n    //         }\n    //     }\n    //     data = body\n    //     // if (getToken()) {\n    //     //     data.ticket = getToken() || '';\n    //     // }\n\n    //     config.data = JSON.stringify(data)\n    // }\n\n    return config\n}, error => {\n    console.log(error) // for debug\n    Promise.reject(error)\n})\nVue.prototype.$http = service\n\nVue.prototype.$post = function (url, data) {\n  return new Promise((resolve, reject) => {\n    service.post(url, data).then(res => {\n      if (res.code == 10001) {\n        resolve(res)\n      } else {\n        ElementUI.Message.error(res.data)\n      }\n    }).catch(err => {\n      // ElementUI.Message.error('网络错误，请重试！')\n      console.log(err)\n      reject(err)\n    })\n  })\n}\n\nVue.prototype.$get = function (url, params = {}) {\n  return new Promise((resolve, reject) => {\n    service.get(url, {\n      params\n    }).then(res => {\n      if (res.code == 10001) {\n        resolve(res)\n      } else {\n        ElementUI.Message.error(res.data)\n      }\n    }).catch(err => {\n      // ElementUI.Message.error('网络错误，请重试！')\n      console.log(err)\n      reject(err)\n    })\n  })\n}\n// respone拦截器\nservice.interceptors.response.use(response => {\n    if (!response.data) {\n        return Promise.reject({code: \"\", message: '网络异常'});\n    }\n    const res = response.data;\n    console.log(res)\n    if (!res.hasOwnProperty('code')) {\n        return res;\n    }\n\n    let expireTime = getLocalStorage('expireTime');\n    if(res.code == 503){\n        console.log(res)\n        dlgUtils.loginTimeout()\n        return Promise.reject({code: res.code, message: res.data})\n    }else{\n        setLocalStorage('expireTime', new Date().getTime() + 1000*60*60*24*7)\n        return res;\n    }\n\n    return Promise.reject({code: res.code, message: res.msg})\n\n}, error => {\n    return Promise.reject({code: error.code, message: error.msg})\n})\nexport default service\n"]}]}